# Copyright (c) 2024 Nuvoton Technology Corporation.
# SPDX-License-Identifier: Apache-2.0

description: |
    The SPI NOR flash devices accessed by Nuvoton Flash Driver.

    Representation of a SPI NOR flash on a qspi bus looks like:

      ext_flash: w25q256jv@0 {
            compatible ="nuvoton,npcm-nor";
            size = <DT_SIZE_K(32 * 8)>;
            reg = <0>;

            qspi-flags = <NPCM_QSPI_SW_CS1>;
            mapped-addr = <0x70000000>;
            pinctrl-0 = <&fiu0_shd_cs_io0_io1_clk_gp44_45_46_47>;
            pinctrl-names = "default";
      };

compatible: "nuvoton,npcm-nor"

include: [flash-controller.yaml, pinctrl-device.yaml, "jedec,spi-nor-common.yaml"]

on-bus: qspi

properties:
  mapped-addr:
    type: int
    description: Mapped memory address of direct read access for spi nor flash.
  max-timeout:
    type: int
    default: 10000
    description: Typically, it equals to max timeout of chip erase in ms.
  qspi-flags:
    type: int
    required: true
    description: The definitions for configuring the Quad-SPI peripherals.
  rd-mode:
    type: string
    default: "NPCM_RD_MODE_FAST_DUAL"
    description: |
      Selects the SPI read access type of Direct Read Access. Usually, we choose
      Fast Read Dual I/O mode for better performance. If the nor spi flash does
      not support this mode, please set this property explicitly.
    enum:
      - "NPCM_RD_MODE_NORMAL" # Direct read access by command code 03h
      - "NPCM_RD_MODE_FAST" # Direct read access by command code 0bh
      - "NPCM_RD_MODE_FAST_DUAL" # Direct read access by command code bbh
      - "NPCM_RD_MODE_QUAD" # Direct read access by command code ebh
